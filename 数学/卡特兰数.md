# 卡特兰数

具体的先不细写。。

## 递推式及通项

$H_n = \sum\limits_{i=0}^{n-1}H_{n-i-1}H_{i}$

$H_n = \frac{2n!}{n!(n+1)!}$

## 开头若干项

有时打表容易注意到这样的数列：

$1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440$

这即是卡特兰数 $H_n = \frac{2n!}{n!(n+1)!}$ ​的开头若干项。

### P1641 [SCOI2010]生成字符串

卡特兰数问题可以转化成折线问题：将非法的线段按y=-1对称后，可以视为从点(0,-2)点出发沿任意路径到原本终点。故该题答案为$\dbinom{n}{n+m} - \dbinom{n+1}{n+m}$。

### P2155 [SDOI2008]沙拉公主的困惑

。。写题解时又忘记怎么写了。

答案为$\sum\limits_{i=1}^{N!}[\operatorname{gcd}(i,M!)=1]$。这里注意N>M，所以$M!|N!$。

考虑到$[1,M!],[M!+1,2M!],\dots,[(\frac{N!}{M!}-1)*M!+1,N!]$每个区间的i的答案都是一样的，仅算一个。

于是有答案$ans = \frac{N!}{M!} * \varphi(M!) = \frac{N!}{M!} M! \prod\limits_{p|M!}\frac{p-1}{p} = N!\prod\limits_{p|M!}\frac{p-1}{p}$，后者可以线性筛筛出。

有些细节，具体看[小粉兔的题解](https://www.luogu.com.cn/problem/solution/P2155)。

