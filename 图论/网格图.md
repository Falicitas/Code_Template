# 网格图

网格图有不少的特殊性质。

## 一些习题

## 扫雷

对于一个网格图，有一些雷。数字则统计周围的8格的雷的个数。

问是否存在另一张图，使另一张图的数字总和等于原图数字总和。

解：直接把图给反过来，即数字换雷，雷换数字，发现是相等的。

这就很神奇了。可以从雷->数字建边算贡献来理解。图反过来了，相当于原来的边反过来了，但是不会有新增的边，所以边的总贡献一样。

### P3350 [ZJOI2016]旅行者

小 $Y$ 来到了一个新的城市旅行。她发现了这个城市的布局是网格状的，也就是有 $n$ 条从东到西的道路和 $m$ 条从南到北的道路，这些道路两两相交形成 $n \times m$ 个路口 $(i, j), \quad(1 \leq i \leq n, 1 \leq j \leq m)$
她发现不同的道路路况不同，所以通过不同的路口需要不同的时间。通过调查发现，从路口 $(i, j)$ 到路口 $(i, j+1)$ 需要时间 $r(i, j)$ ，从路口 $(i, j)$ 到路口 $(i+1, j)$ 需要时间 $c(i, j)$ 。注意这里的道路是双向 的。小 $Y$ 有 $q$ 个询问，她想知道从路口 $(x 1, y 1)$ 到路口 $(x 2, y 2)$ 最少需要花多少时间。

这个题利用网格图的最短路特性，由于每个点对的查询是随机在网格的位置，那么将网格图对半分，对于处在网格图左右部分的查询点必然要经过中间的轴线上的点。

于是考虑每次只求轴线上的点到整个网格图的最短路，那么对于任意被轴线隔开的查询点，答案即为 $d((x_1,y_1),中轴线某一点)+d(中轴线某一点,(x_2,y_2))$​。对于其他仍处在当前网格图的查询点也需要更新一下（由于一个点对的最短路需要经过中轴线再绕回所处的网格范围）

比起复杂度 $O(qnm)$​​，明显 $O(nm\log nm)$ ​​级别更优秀。故采用这种分治的办法来求解。本质是利用的网格图两点路径必然要经过某条 **人为规划** 的界线，以此来在界线上求最短路来更新查询点对。